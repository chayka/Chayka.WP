Chayka\WP\Query
===============

Ok, this is where it all began. When I decided that I need to bring MVC/OOP principles to WP,
I was looking for the way to embed ZendFramework MVC application into WP.

Later I replaced ZF with my own lightweight Chayka.MVC framework.

But this class is actually the place where WP meets Chayka.Framework.

This class overrides main WP_Query object that is stored in global $wp_query or $wp_the_query.
The static method of Chayka\WP\Query::parseRequest() is hooked to parse_request hook.
It compares the request to the list of registered MVC application routes
(from different Chayka powered themes and plugins) and if matched calls appropriate
controller & action using get_posts() method.

The overridden get_posts() method returns one faked post that is assembled using content
generated by controller action. This post thereafter outputted using /src/Chayka/WP/index.php
template.

And there's more to it. For example you have some controller action that serves url:
     /my-awesome-controller/awesome-action/awesome-param/awesome-value

If you prepend it with /api/ prefix you'll get the pure response of the action
not wrapped into header & footer. Amazing! Just like that:
     /api/my-awesome-controller/awesome-action/awesome-param/awesome-value

And don't forget to revise JsonHelper::respond() to wrap all your json api responses
into uniform json envelopes.


* Class name: Query
* Namespace: Chayka\WP
* Parent class: WP_Query





Properties
----------


### $_post

    protected \Chayka\WP\Models\PostModel $_post = null

This is the representation of the faked post that will be returned as result of controller action.

It will be converted into standard WP_Post object and returned by get_posts().

You can get it by Query::getPost() to set title, description, id, etc.
Or you can set all those post properties at once by Query::setPost($post) if your controller action
renders some custom post page.`

* Visibility: **protected**
* This property is **static**.


### $template

    protected string $template = null

As noted before the response is outputted using /src/Chayka/WP/index.php
However you can specify custom output template using Query::setTemplate().



* Visibility: **protected**
* This property is **static**.


Methods
-------


### parseRequest

    mixed Chayka\WP\Query::parseRequest()

This function is called on parse_request hook.

If it detects url that can be processed by any registered application it replaces
$wp_the_query with this modified WP_Query extended instance.
On get_posts it will return modified $post with MVC Application rendered content.

* Visibility: **public**
* This method is **static**.




### copyFrom

    mixed Chayka\WP\Query::copyFrom(\WP_Query $wp_query)

Get all the data from provided query.



* Visibility: **public**


#### Arguments
* $wp_query **WP_Query**



### setPost

    \Chayka\WP\Models\PostModel Chayka\WP\Query::setPost(\Chayka\WP\Models\PostModel|\WP_Post $post)

Set post data that will be returned by get_posts().

'post_content' will be replaced by MVC Application response.

* Visibility: **public**
* This method is **static**.


#### Arguments
* $post **[Chayka\WP\Models\PostModel](Chayka-WP-Models-PostModel.md)|WP_Post**



### getPost

    \Chayka\WP\Models\PostModel Chayka\WP\Query::getPost()

Get current rendered post instance.

Init it if one is absent.

* Visibility: **public**
* This method is **static**.




### getTemplate

    null|string Chayka\WP\Query::getTemplate()

As noted before the response is outputted using /src/Chayka/WP/index.php
However you can specify custom output template using Query::setTemplate().

You can check what template is set using this function.
If it returns null, consider it /src/Chayka/WP/index.php

* Visibility: **public**
* This method is **static**.




### setTemplate

    mixed Chayka\WP\Query::setTemplate(null|string $template)

As noted before the response is outputted using /src/Chayka/WP/index.php
However you can specify custom output template using Query::setTemplate().



* Visibility: **public**
* This method is **static**.


#### Arguments
* $template **null|string**



### getProperty

    mixed Chayka\WP\Query::getProperty($key, string $default)

Get query property



* Visibility: **public**
* This method is **static**.


#### Arguments
* $key **mixed**
* $default **string**



### setProperty

    mixed Chayka\WP\Query::setProperty($key, $value)

Set query property



* Visibility: **public**
* This method is **static**.


#### Arguments
* $key **mixed**
* $value **mixed**



### getIsHome

    boolean Chayka\WP\Query::getIsHome()

Check if current request is considered by WP as home page.

Alias to is_home()

* Visibility: **public**
* This method is **static**.




### setIsHome

    mixed Chayka\WP\Query::setIsHome(boolean|true $is)

Set is_home property



* Visibility: **public**
* This method is **static**.


#### Arguments
* $is **boolean|true**



### getIsArchive

    boolean Chayka\WP\Query::getIsArchive()

Check if current request is considered by WP as archive page.

Alias to is_archive()

* Visibility: **public**
* This method is **static**.




### setIsArchive

    mixed Chayka\WP\Query::setIsArchive(boolean|true $is)

Set is_archive property



* Visibility: **public**
* This method is **static**.


#### Arguments
* $is **boolean|true**



### getIsSearch

    boolean Chayka\WP\Query::getIsSearch()

Check if current request is considered by WP as archive page.

Alias to is_search()

* Visibility: **public**
* This method is **static**.




### setIsSearch

    mixed Chayka\WP\Query::setIsSearch(boolean|true $is)

Set is_search property



* Visibility: **public**
* This method is **static**.


#### Arguments
* $is **boolean|true**



### getIs404

    boolean Chayka\WP\Query::getIs404()

Check if current request is considered by WP as 404 page.

Alias to is_search()

* Visibility: **public**
* This method is **static**.




### setIs404

    mixed Chayka\WP\Query::setIs404(boolean|true $is)

Set is_404 property



* Visibility: **public**
* This method is **static**.


#### Arguments
* $is **boolean|true**



### get_posts

    array Chayka\WP\Query::get_posts()

This is our overridden get_posts() method that returns an array with one faked post,
generated by our MVC controller action.

If controller action returned:
     return $this->setNotFound404()
then empty array will be returned and WP will use 404.php of current theme.

404.php is also used when controller action throws an uncaught exception.

* Visibility: **public**




### renderResponse

    null|string Chayka\WP\Query::renderResponse($template)

This function is hooked to 'single_template' and provides template to render our response.

We need that unused param as apply_filters will call it with param

* Visibility: **public**
* This method is **static**.


#### Arguments
* $template **mixed**


